#!/bin/bash

# Raise windows of apps by passing the app name as argument
# Example:
#
#    $ focus firefox

# Get target app from first argument
target_app=$1

# Get id of active window
active_win_id=$(xprop -root | grep '^_NET_ACTIVE_W' | awk -F'# 0x' '{print $2}' | awk -F', ' '{print $1}')
if [ "$active_win_id" == "0" ]; then
    active_win_id=""
fi

# Get list of windows that belong to the target app
win_list=$(wmctrl -lx | grep -i "$target_app" | tr -s " " )

# Remove active window from the list
if [[ $active_win_id != "" ]]; then
    win_list=$(echo "$win_list" | grep -v "$active_win_id")
fi

# Exit if win_list is empty
if [[ $win_list == "" ]]; then
    exit
fi

# Choose the first window in the list as the target window
target_win=$(echo "$win_list" | head -n 1)
target_win_id=$(echo "$target_win" | cut -d " " -f 1)
target_win_workspace=$(echo "$target_win" | cut -d " " -f 2)

# Switch to target window
wmctrl -s "$target_win_workspace"
wmctrl -ia "$target_win_id"
